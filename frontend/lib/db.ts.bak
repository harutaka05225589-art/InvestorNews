
// Helper wrapper to ensure safety
export function getDailyIREvents(dateStr: string): { count: number, events: { ticker: string, name: string, market?: string }[] } {
    try {
        const countStmt = db.prepare('SELECT COUNT(*) as count FROM ir_events WHERE event_date = ?');
        const count = (countStmt.get(dateStr) as { count: number }).count;

        // Select market column
        const eventsStmt = db.prepare('SELECT ticker, company_name as name, market FROM ir_events WHERE event_date = ? LIMIT 5');
        const events = eventsStmt.all(dateStr) as { ticker: string, name: string, market: string }[];

        return { count, events };
    } catch (e) {
        console.error("Error fetching daily IR events:", e);
        return { count: 0, events: [] };
    }
}
